<html xmlns:f="http://typo3.org/ns/TYPO3/CMS/Fluid/ViewHelpers"
      xmlns:gadgetoGoogle="http://typo3.org/ns/Madj2k/GadgetoGoogle/ViewHelpers"
      data-namespace-typo3-fluid="true">

    <f:comment><!-- Now add some HTML for the overlays --></f:comment>
    <f:if condition="{locations}">
        <f:then>
            <f:for each="{locations}" as="location">
                <f:render partial="Map/Overlay"
                          arguments="{location: location, data: data, settings: settings, settingsForLayout: settingsForLayout}" />
            </f:for>
    
            <f:comment><!--
                Init the map. Optionally you can add a "locationCenter" to explicitl define the center of the map.
                Otherwise the first place is used. Don't forget to add an overlay-element for it!
                
                Example for an additional canvas-config with a raw red mask around Germany
                <f:variable name="canvas" value="{
                  enabled: true,
                  jsonCoordinates: '[[5.866,47.270],[5.866,55.059],[9.921,55.059],[14.988,55.009],[15.041,50.743],[13.095,48.555],[10.454,47.270],[5.866,47.270]]',
                  fillStyle: 'rgba(255, 0, 0, 0.5)'
                }" />     
            --></f:comment>
            <f:variable name="overlay" value="" />
            <f:if condition="{locationCenter}">
                <f:then>
                    <f:render partial="Map/Overlay" 
                              arguments="{location: locationCenter, data: data, settings: settings, settingsForLayout: settingsForLayout}" />
                    
                    <f:render partial="Map/ClusterMarker" 
                              arguments="{data: data, settings: settings, settingsForLayout: settingsForLayout}" />
                    <gadgetoGoogle:googleMaps locations="{locations}" locationCenter="{locationCenter}" settings="{settings}" canvas="{canvas}"/>
                </f:then>
                <f:else>
                    <f:render partial="Map/ClusterMarker" 
                              arguments="{data: data, settings: settings, settingsForLayout: settingsForLayout}" />
                    <gadgetoGoogle:googleMaps locations="{locations}" settings="{settings}" canvas="{canvas}"/>
                </f:else>
            </f:if>
    
            <f:comment><!-- Set container of the map. --></f:comment>
            <f:render partial="Map/Container" 
                      arguments="{data: data, settings: settings, settingsForLayout: settingsForLayout}" />
        </f:then>
        <f:else>
            <f:if condition="{search.isActive}">
                <div class="alert alert-warning" role="alert">
                    <p><f:translate key="label.noResults" extensionName="gadgeto_google" /></p>
                </div>
            </f:if>
        </f:else>
    </f:if>

</html>